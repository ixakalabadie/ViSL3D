<!DOCTYPE html>
	 <head>
		<script type='text/javascript' src='x3dom/x3dom.js'></script>
		<script type='text/javascript'  src='https://www.maths.nottingham.ac.uk/plp/pmadw/LaTeXMathML.js'></script>
		<link rel='stylesheet' type='text/css' href='x3dom/x3dom.css'></link>
		<script type='text/javascript' src='https://code.jquery.com/jquery-3.6.3.min.js'></script>
		<script src="x3dom/js-colormaps.js"></script> <!-- FOR COLORMAPS IN JS-->
		<script type="text/javascript" src="x3dom/markers.js"></script> <!-- FOR MARKERS IN JS-->
		<title> HCG16 </title>

		<style>
			x3d
				{
					border:2px solid darkorange;
					width:95vw;
					height: 75vh;
			}
			</style>
	</head>
	<body>
	<h1 align="middle"> HCG16 </h1>
	<hr/>
	<script>
		 //Round a float value to x.xx format
		function roundTo(value, decimals)
		{
			return (Math.round(value * 10**decimals)) / 10**decimals;
		 }
	</script>
		<script>
			function hideall0() {
				setHI0layer0();
				setHI0layer1();
				setHI0layer2();
				setHI0layer3();
			}
			function hideall1() {
				setHI1layer0();
				setHI1layer1();
				setHI1layer2();
				setHI1layer3();
			}
		</script>
	 <script>
	 	 function setHI0layer0()
	 	 {
	 	 if(document.getElementById('cube__0layer0_sp0').getAttribute('transparency') != '0.8') {
		 document.getElementById('0but0').style.border = '5px dashed black';
		 document.getElementById('cube__0layer0_sp0').setAttribute('transparency', '0.8');
		 document.getElementById('cube__0layer0_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('0but0').style.border = 'inset black';
		 document.getElementById('cube__0layer0_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__0layer0_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
	 <script>
	 	 function setHI0layer1()
	 	 {
	 	 if(document.getElementById('cube__0layer1_sp0').getAttribute('transparency') != '0.8') {
		 document.getElementById('0but1').style.border = '5px dashed black';
		 document.getElementById('cube__0layer1_sp0').setAttribute('transparency', '0.8');
		 document.getElementById('cube__0layer1_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('0but1').style.border = 'inset black';
		 document.getElementById('cube__0layer1_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__0layer1_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
	 <script>
	 	 function setHI0layer2()
	 	 {
	 	 if(document.getElementById('cube__0layer2_sp0').getAttribute('transparency') != '0.8') {
		 document.getElementById('0but2').style.border = '5px dashed black';
		 document.getElementById('cube__0layer2_sp0').setAttribute('transparency', '0.8');
		 document.getElementById('cube__0layer2_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('0but2').style.border = 'inset black';
		 document.getElementById('cube__0layer2_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__0layer2_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
	 <script>
		 function setHI0layer3()
		 {
	 	 if(document.getElementById('cube__0layer3_sp0').getAttribute('transparency') != '0.4') {
		 document.getElementById('0but3').style.border = '5px dashed black';
		 document.getElementById('cube__0layer3_sp0').setAttribute('transparency', '0.4');
		 document.getElementById('cube__0layer3_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('0but3').style.border = 'inset black';
		 document.getElementById('cube__0layer3_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__0layer3_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
	 <script>
	 	 function setHI1layer0()
	 	 {
	 	 if(document.getElementById('cube__1layer0_sp0').getAttribute('transparency') != '0.8') {
		 document.getElementById('1but0').style.border = '5px dashed black';
		 document.getElementById('cube__1layer0_sp0').setAttribute('transparency', '0.8');
		 document.getElementById('cube__1layer0_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('1but0').style.border = 'inset black';
		 document.getElementById('cube__1layer0_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__1layer0_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
	 <script>
	 	 function setHI1layer1()
	 	 {
	 	 if(document.getElementById('cube__1layer1_sp0').getAttribute('transparency') != '0.8') {
		 document.getElementById('1but1').style.border = '5px dashed black';
		 document.getElementById('cube__1layer1_sp0').setAttribute('transparency', '0.8');
		 document.getElementById('cube__1layer1_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('1but1').style.border = 'inset black';
		 document.getElementById('cube__1layer1_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__1layer1_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
	 <script>
	 	 function setHI1layer2()
	 	 {
	 	 if(document.getElementById('cube__1layer2_sp0').getAttribute('transparency') != '0.8') {
		 document.getElementById('1but2').style.border = '5px dashed black';
		 document.getElementById('cube__1layer2_sp0').setAttribute('transparency', '0.8');
		 document.getElementById('cube__1layer2_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('1but2').style.border = 'inset black';
		 document.getElementById('cube__1layer2_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__1layer2_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
	 <script>
		 function setHI1layer3()
		 {
	 	 if(document.getElementById('cube__1layer3_sp0').getAttribute('transparency') != '0.4') {
		 document.getElementById('1but3').style.border = '5px dashed black';
		 document.getElementById('cube__1layer3_sp0').setAttribute('transparency', '0.4');
		 document.getElementById('cube__1layer3_sp0_shape').setAttribute('ispickable', 'true');
		 } else { 
		 document.getElementById('1but3').style.border = 'inset black';
		 document.getElementById('cube__1layer3_sp0').setAttribute('transparency', '1');
		 document.getElementById('cube__1layer3_sp0_shape').setAttribute('ispickable', 'false');
		 } 
		 }
	 </script>
		<script>
		function setgrids()
		{
			if(document.getElementById('cube__ticklines').getAttribute('transparency') == '0') {
				document.getElementById('cube__ticklines').setAttribute('transparency', '1');
			} else if (document.getElementById('cube__outline').getAttribute('transparency') == '0') {
				document.getElementById('cube__outline').setAttribute('transparency', '1');
			} else {
				document.getElementById('cube__ticklines').setAttribute('transparency', '0');
				document.getElementById('cube__outline').setAttribute('transparency', '0');
			}
		}
		 </script>
		<script>
		function setaxes()
		{
		if(document.getElementById('cube__axlab_diff1').getAttribute('transparency') == '0') {
			for (i=0; i<12; i++) {
			if (i<6) {
				document.getElementById('cube__axlab_diff'+i).setAttribute('transparency', '1');
			}
				document.getElementById('cube__axtick_diff'+i).setAttribute('transparency', '1');
			}
		}
		else {
			for (i=0; i<12; i++) {
			if (i<6) {
				document.getElementById('cube__axlab_diff'+i).setAttribute('transparency', '0');
			}
				document.getElementById('cube__axtick_diff'+i).setAttribute('transparency', '0');
			}
		 }
		 }
		 </script>

	<script>
		var active = false;
		function animation() {
			if (active == false) {
				document.getElementById('cube__time').setAttribute('startTime', document.getElementById('cube__time').getAttribute('time'));
				document.getElementById('cube__time').setAttribute('isPaused', 'false');
				active = true;
			} else if (document.getElementById('cube__time').getAttribute('isPaused') == 'false') {
				document.getElementById('cube__time').setAttribute('loop', 'false');
				document.getElementById('cube__time').setAttribute('isPaused', 'true')
			} else {
				document.getElementById('cube__time').setAttribute('loop', 'true');
				document.getElementById('cube__time').setAttribute('isPaused', 'false');
			}
		}
	</script>
	<center><x3d id='cubeFixed'>
		<scene>
			<OrthoViewpoint id="front" bind='false' centerOfRotation='0,0,0' description='RA-Dec view' fieldOfView='[-1400.0,-1400.0,1400.0,1400.0]' isActive='false' metadata='X3DMetadataObject' orientation='0,1,0,3.141593' position='0,0,-5500' zFar='11000' zNear='0.0001' ></OrthoViewpoint>
			<OrthoViewpoint id="side" bind='false' centerOfRotation='0,0,0' description='Z - Dec view' fieldOfView='[-1400.0,-1400.0,1400.0,1400.0]' isActive='false' metadata='X3DMetadataObject' orientation='0,-1,0,1.570796' position='-5500,0,0' zFar='11000' zNear='0.0001' ></OrthoViewpoint>
			<OrthoViewpoint id="side2" bind='false' centerOfRotation='0,0,0' description='Z - RA view' fieldOfView='[-1400.0,-1400.0,1400.0,1400.0]' isActive='false' metadata='X3DMetadataObject' orientation='1,1,1,4.1888' position='0,5500,0' zFar='11000' zNear='0.0001' ></OrthoViewpoint>
			<inline url="HCG16_overlay.x3d" nameSpaceName="cube" mapDEFToID="true" onclick="" onload="loading()"/>
		</scene>
	</x3d></center>
	<div style="width:90%">
		<br/>
		&nbsp <b>Viewpoints:</b>
			<button onclick="document.getElementById('cubeFixed').runtime.resetView();">Reset View</button>
			<button onclick="document.getElementById('front').setAttribute('set_bind','true');"> R.A. - Dec. </button>
			<button onclick="document.getElementById('side').setAttribute('set_bind','true');"> Z - Dec. </button>
			<button onclick="document.getElementById('side2').setAttribute('set_bind','true');"> Z - R.A. </button>

		<br><br>

		&nbsp <b>Labels:</b>
			<button onclick="setgrids();" >Grids</button>
			<button onclick="setaxes();" >Axes labels</button>
			<button id="anim" onclick="animation()">Animation</button>		<br><br>
		&nbsp <b>Line 1 (3600.0 km / s) (Jy/beam):</b>
			<button id="0but0" onclick="setHI0layer0();" style="font-size:20px ; border:5px dashed black ; background:rgb(255 244 239) ; color:black"><b>10.000</b></button>
			<button id="0but1" onclick="setHI0layer1();" style="font-size:20px ; border:5px dashed black ; background:rgb(253 208 189) ; color:black"><b>20.000</b></button>
			<button id="0but2" onclick="setHI0layer2();" style="font-size:20px ; border:5px dashed black ; background:rgb(251 134 102) ; color:black"><b>33.333</b></button>
			<button id="0but3" onclick="setHI0layer3();" style="font-size:20px ; border:5px dashed black ; background:rgb(103   0  13) ; color:white"><b>66.667</b></button>
			&nbsp <button id="all" onclick="hideall0()"><b>Invert</b></button>		<br><br>
		&nbsp <b>Line 2 (3850.0 km / s) (Jy/beam):</b>
			<button id="1but0" onclick="setHI1layer0();" style="font-size:20px ; border:5px dashed black ; background:rgb(246 251 255) ; color:black"><b>10.000</b></button>
			<button id="1but1" onclick="setHI1layer1();" style="font-size:20px ; border:5px dashed black ; background:rgb(212 228 243) ; color:black"><b>20.000</b></button>
			<button id="1but2" onclick="setHI1layer2();" style="font-size:20px ; border:5px dashed black ; background:rgb(142 193 221) ; color:black"><b>33.333</b></button>
			<button id="1but3" onclick="setHI1layer3();" style="font-size:20px ; border:5px dashed black ; background:rgb(  7  47 107) ; color:white"><b>66.667</b></button>
			&nbsp <button id="all" onclick="hideall1()"><b>Invert</b></button>		<br><br>
		&nbsp <label for="cmaps-choice0"><b>Cmap Line 1</b> </label>
		<select id="cmaps-choice0">
			<option value="CMRmap_r">CMRmap_r</option>
			<option value="magma">magma</option>
			<option value="inferno">inferno</option>
			<option value="plasma">plasma</option>
			<option value="viridis">viridis</option>
			<option value="cividis">cividis</option>
			<option value="twilight">twilight</option>
			<option value="twilight_shifted">twilight_shifted</option>
			<option value="turbo">turbo</option>
			<option value="Blues">Blues</option>
			<option value="BrBG">BrBG</option>
			<option value="BuGn">BuGn</option>
			<option value="BuPu">BuPu</option>
			<option value="CMRmap">CMRmap</option>
			<option value="GnBu">GnBu</option>
			<option value="Greens">Greens</option>
			<option value="Greys">Greys</option>
			<option value="OrRd">OrRd</option>
			<option value="Oranges">Oranges</option>
			<option value="PRGn">PRGn</option>
			<option value="PiYG">PiYG</option>
			<option value="PuBu">PuBu</option>
			<option value="PuBuGn">PuBuGn</option>
			<option value="PuOr">PuOr</option>
			<option value="PuRd">PuRd</option>
			<option value="Purples">Purples</option>
			<option value="RdBu">RdBu</option>
			<option value="RdGy">RdGy</option>
			<option value="RdPu">RdPu</option>
			<option value="RdYlBu">RdYlBu</option>
			<option value="RdYlGn">RdYlGn</option>
			<option value="Reds">Reds</option>
			<option value="Spectral">Spectral</option>
			<option value="Wistia">Wistia</option>
			<option value="YlGn">YlGn</option>
			<option value="YlGnBu">YlGnBu</option>
			<option value="YlOrBr">YlOrBr</option>
			<option value="YlOrRd">YlOrRd</option>
			<option value="afmhot">afmhot</option>
			<option value="autumn">autumn</option>
			<option value="binary">binary</option>
			<option value="bone">bone</option>
			<option value="brg">brg</option>
			<option value="bwr">bwr</option>
			<option value="cool">cool</option>
			<option value="coolwarm">coolwarm</option>
			<option value="copper">copper</option>
			<option value="cubehelix">cubehelix</option>
			<option value="flag">flag</option>
			<option value="gist_earth">gist_earth</option>
			<option value="gist_gray">gist_gray</option>
			<option value="gist_heat">gist_heat</option>
			<option value="gist_ncar">gist_ncar</option>
			<option value="gist_rainbow">gist_rainbow</option>
			<option value="gist_stern">gist_stern</option>
			<option value="gist_yarg">gist_yarg</option>
			<option value="gnuplot">gnuplot</option>
			<option value="gnuplot2">gnuplot2</option>
			<option value="gray">gray</option>
			<option value="hot">hot</option>
			<option value="hsv">hsv</option>
			<option value="jet">jet</option>
			<option value="nipy_spectral">nipy_spectral</option>
			<option value="ocean">ocean</option>
			<option value="pink">pink</option>
			<option value="prism">prism</option>
			<option value="rainbow">rainbow</option>
			<option value="seismic">seismic</option>
			<option value="spring">spring</option>
			<option value="summer">summer</option>
			<option value="terrain">terrain</option>
			<option value="winter">winter</option>
			<option value="Accent">Accent</option>
			<option value="Dark2">Dark2</option>
			<option value="Paired">Paired</option>
			<option value="Pastel1">Pastel1</option>
			<option value="Pastel2">Pastel2</option>
			<option value="Set1">Set1</option>
			<option value="Set2">Set2</option>
			<option value="Set3">Set3</option>
			<option value="tab10">tab10</option>
			<option value="tab20">tab20</option>
			<option value="tab20b">tab20b</option>
			<option value="tab20c">tab20c</option>
			<option value="magma_r">magma_r</option>
			<option value="inferno_r">inferno_r</option>
			<option value="plasma_r">plasma_r</option>
			<option value="viridis_r">viridis_r</option>
			<option value="cividis_r">cividis_r</option>
			<option value="twilight_r">twilight_r</option>
			<option value="twilight_shifted_r">twilight_shifted_r</option>
			<option value="turbo_r">turbo_r</option>
			<option value="Blues_r">Blues_r</option>
			<option value="BrBG_r">BrBG_r</option>
			<option value="BuGn_r">BuGn_r</option>
			<option value="BuPu_r">BuPu_r</option>
			<option value="GnBu_r">GnBu_r</option>
			<option value="Greens_r">Greens_r</option>
			<option value="Greys_r">Greys_r</option>
			<option value="OrRd_r">OrRd_r</option>
			<option value="Oranges_r">Oranges_r</option>
			<option value="PRGn_r">PRGn_r</option>
			<option value="PiYG_r">PiYG_r</option>
			<option value="PuBu_r">PuBu_r</option>
			<option value="PuBuGn_r">PuBuGn_r</option>
			<option value="PuOr_r">PuOr_r</option>
			<option value="PuRd_r">PuRd_r</option>
			<option value="Purples_r">Purples_r</option>
			<option value="RdBu_r">RdBu_r</option>
			<option value="RdGy_r">RdGy_r</option>
			<option value="RdPu_r">RdPu_r</option>
			<option value="RdYlBu_r">RdYlBu_r</option>
			<option value="RdYlGn_r">RdYlGn_r</option>
			<option value="Reds_r">Reds_r</option>
			<option value="Spectral_r">Spectral_r</option>
			<option value="Wistia_r">Wistia_r</option>
			<option value="YlGn_r">YlGn_r</option>
			<option value="YlGnBu_r">YlGnBu_r</option>
			<option value="YlOrBr_r">YlOrBr_r</option>
			<option value="YlOrRd_r">YlOrRd_r</option>
			<option value="afmhot_r">afmhot_r</option>
			<option value="autumn_r">autumn_r</option>
			<option value="binary_r">binary_r</option>
			<option value="bone_r">bone_r</option>
			<option value="brg_r">brg_r</option>
			<option value="bwr_r">bwr_r</option>
			<option value="cool_r">cool_r</option>
			<option value="coolwarm_r">coolwarm_r</option>
			<option value="copper_r">copper_r</option>
			<option value="cubehelix_r">cubehelix_r</option>
			<option value="flag_r">flag_r</option>
			<option value="gist_earth_r">gist_earth_r</option>
			<option value="gist_gray_r">gist_gray_r</option>
			<option value="gist_heat_r">gist_heat_r</option>
			<option value="gist_ncar_r">gist_ncar_r</option>
			<option value="gist_rainbow_r">gist_rainbow_r</option>
			<option value="gist_stern_r">gist_stern_r</option>
			<option value="gist_yarg_r">gist_yarg_r</option>
			<option value="gnuplot_r">gnuplot_r</option>
			<option value="gnuplot2_r">gnuplot2_r</option>
			<option value="gray_r">gray_r</option>
			<option value="hot_r">hot_r</option>
			<option value="hsv_r">hsv_r</option>
			<option value="jet_r">jet_r</option>
			<option value="nipy_spectral_r">nipy_spectral_r</option>
			<option value="ocean_r">ocean_r</option>
			<option value="pink_r">pink_r</option>
			<option value="prism_r">prism_r</option>
			<option value="rainbow_r">rainbow_r</option>
			<option value="seismic_r">seismic_r</option>
			<option value="spring_r">spring_r</option>
			<option value="summer_r">summer_r</option>
			<option value="terrain_r">terrain_r</option>
			<option value="winter_r">winter_r</option>
			<option value="Accent_r">Accent_r</option>
			<option value="Dark2_r">Dark2_r</option>
			<option value="Paired_r">Paired_r</option>
			<option value="Pastel1_r">Pastel1_r</option>
			<option value="Pastel2_r">Pastel2_r</option>
			<option value="Set1_r">Set1_r</option>
			<option value="Set2_r">Set2_r</option>
			<option value="Set3_r">Set3_r</option>
			<option value="tab10_r">tab10_r</option>
			<option value="tab20_r">tab20_r</option>
			<option value="tab20b_r">tab20b_r</option>
			<option value="tab20c_r">tab20c_r</option>
		</select>
		<label for="cmaps-min0"><b>Min 0:</b> </label>
		<input id="cmaps-min0" type="number" value="10.0">
		<label for="cmaps-max0"><b>Max 0:</b> </label>
		<input id="cmaps-max0" type="number" value="66.66666666666667">
		<label for="cmaps-min0"><b>Scale 0:</b> </label>
		<select id="cmaps-scale0">
			<option value="linear" selected="selected">linear</option>
			<option value="log">log</option>
			<option value="sqrt">sqrt</option>
			<option value="power">power</option>
			<option value="asinh">asinh</option>
		</select>
		&nbsp <label for="cmaps-choice1"><b>Cmap Line 2</b> </label>
		<select id="cmaps-choice1">
			<option value="CMRmap_r">CMRmap_r</option>
			<option value="magma">magma</option>
			<option value="inferno">inferno</option>
			<option value="plasma">plasma</option>
			<option value="viridis">viridis</option>
			<option value="cividis">cividis</option>
			<option value="twilight">twilight</option>
			<option value="twilight_shifted">twilight_shifted</option>
			<option value="turbo">turbo</option>
			<option value="Blues">Blues</option>
			<option value="BrBG">BrBG</option>
			<option value="BuGn">BuGn</option>
			<option value="BuPu">BuPu</option>
			<option value="CMRmap">CMRmap</option>
			<option value="GnBu">GnBu</option>
			<option value="Greens">Greens</option>
			<option value="Greys">Greys</option>
			<option value="OrRd">OrRd</option>
			<option value="Oranges">Oranges</option>
			<option value="PRGn">PRGn</option>
			<option value="PiYG">PiYG</option>
			<option value="PuBu">PuBu</option>
			<option value="PuBuGn">PuBuGn</option>
			<option value="PuOr">PuOr</option>
			<option value="PuRd">PuRd</option>
			<option value="Purples">Purples</option>
			<option value="RdBu">RdBu</option>
			<option value="RdGy">RdGy</option>
			<option value="RdPu">RdPu</option>
			<option value="RdYlBu">RdYlBu</option>
			<option value="RdYlGn">RdYlGn</option>
			<option value="Reds">Reds</option>
			<option value="Spectral">Spectral</option>
			<option value="Wistia">Wistia</option>
			<option value="YlGn">YlGn</option>
			<option value="YlGnBu">YlGnBu</option>
			<option value="YlOrBr">YlOrBr</option>
			<option value="YlOrRd">YlOrRd</option>
			<option value="afmhot">afmhot</option>
			<option value="autumn">autumn</option>
			<option value="binary">binary</option>
			<option value="bone">bone</option>
			<option value="brg">brg</option>
			<option value="bwr">bwr</option>
			<option value="cool">cool</option>
			<option value="coolwarm">coolwarm</option>
			<option value="copper">copper</option>
			<option value="cubehelix">cubehelix</option>
			<option value="flag">flag</option>
			<option value="gist_earth">gist_earth</option>
			<option value="gist_gray">gist_gray</option>
			<option value="gist_heat">gist_heat</option>
			<option value="gist_ncar">gist_ncar</option>
			<option value="gist_rainbow">gist_rainbow</option>
			<option value="gist_stern">gist_stern</option>
			<option value="gist_yarg">gist_yarg</option>
			<option value="gnuplot">gnuplot</option>
			<option value="gnuplot2">gnuplot2</option>
			<option value="gray">gray</option>
			<option value="hot">hot</option>
			<option value="hsv">hsv</option>
			<option value="jet">jet</option>
			<option value="nipy_spectral">nipy_spectral</option>
			<option value="ocean">ocean</option>
			<option value="pink">pink</option>
			<option value="prism">prism</option>
			<option value="rainbow">rainbow</option>
			<option value="seismic">seismic</option>
			<option value="spring">spring</option>
			<option value="summer">summer</option>
			<option value="terrain">terrain</option>
			<option value="winter">winter</option>
			<option value="Accent">Accent</option>
			<option value="Dark2">Dark2</option>
			<option value="Paired">Paired</option>
			<option value="Pastel1">Pastel1</option>
			<option value="Pastel2">Pastel2</option>
			<option value="Set1">Set1</option>
			<option value="Set2">Set2</option>
			<option value="Set3">Set3</option>
			<option value="tab10">tab10</option>
			<option value="tab20">tab20</option>
			<option value="tab20b">tab20b</option>
			<option value="tab20c">tab20c</option>
			<option value="magma_r">magma_r</option>
			<option value="inferno_r">inferno_r</option>
			<option value="plasma_r">plasma_r</option>
			<option value="viridis_r">viridis_r</option>
			<option value="cividis_r">cividis_r</option>
			<option value="twilight_r">twilight_r</option>
			<option value="twilight_shifted_r">twilight_shifted_r</option>
			<option value="turbo_r">turbo_r</option>
			<option value="Blues_r">Blues_r</option>
			<option value="BrBG_r">BrBG_r</option>
			<option value="BuGn_r">BuGn_r</option>
			<option value="BuPu_r">BuPu_r</option>
			<option value="GnBu_r">GnBu_r</option>
			<option value="Greens_r">Greens_r</option>
			<option value="Greys_r">Greys_r</option>
			<option value="OrRd_r">OrRd_r</option>
			<option value="Oranges_r">Oranges_r</option>
			<option value="PRGn_r">PRGn_r</option>
			<option value="PiYG_r">PiYG_r</option>
			<option value="PuBu_r">PuBu_r</option>
			<option value="PuBuGn_r">PuBuGn_r</option>
			<option value="PuOr_r">PuOr_r</option>
			<option value="PuRd_r">PuRd_r</option>
			<option value="Purples_r">Purples_r</option>
			<option value="RdBu_r">RdBu_r</option>
			<option value="RdGy_r">RdGy_r</option>
			<option value="RdPu_r">RdPu_r</option>
			<option value="RdYlBu_r">RdYlBu_r</option>
			<option value="RdYlGn_r">RdYlGn_r</option>
			<option value="Reds_r">Reds_r</option>
			<option value="Spectral_r">Spectral_r</option>
			<option value="Wistia_r">Wistia_r</option>
			<option value="YlGn_r">YlGn_r</option>
			<option value="YlGnBu_r">YlGnBu_r</option>
			<option value="YlOrBr_r">YlOrBr_r</option>
			<option value="YlOrRd_r">YlOrRd_r</option>
			<option value="afmhot_r">afmhot_r</option>
			<option value="autumn_r">autumn_r</option>
			<option value="binary_r">binary_r</option>
			<option value="bone_r">bone_r</option>
			<option value="brg_r">brg_r</option>
			<option value="bwr_r">bwr_r</option>
			<option value="cool_r">cool_r</option>
			<option value="coolwarm_r">coolwarm_r</option>
			<option value="copper_r">copper_r</option>
			<option value="cubehelix_r">cubehelix_r</option>
			<option value="flag_r">flag_r</option>
			<option value="gist_earth_r">gist_earth_r</option>
			<option value="gist_gray_r">gist_gray_r</option>
			<option value="gist_heat_r">gist_heat_r</option>
			<option value="gist_ncar_r">gist_ncar_r</option>
			<option value="gist_rainbow_r">gist_rainbow_r</option>
			<option value="gist_stern_r">gist_stern_r</option>
			<option value="gist_yarg_r">gist_yarg_r</option>
			<option value="gnuplot_r">gnuplot_r</option>
			<option value="gnuplot2_r">gnuplot2_r</option>
			<option value="gray_r">gray_r</option>
			<option value="hot_r">hot_r</option>
			<option value="hsv_r">hsv_r</option>
			<option value="jet_r">jet_r</option>
			<option value="nipy_spectral_r">nipy_spectral_r</option>
			<option value="ocean_r">ocean_r</option>
			<option value="pink_r">pink_r</option>
			<option value="prism_r">prism_r</option>
			<option value="rainbow_r">rainbow_r</option>
			<option value="seismic_r">seismic_r</option>
			<option value="spring_r">spring_r</option>
			<option value="summer_r">summer_r</option>
			<option value="terrain_r">terrain_r</option>
			<option value="winter_r">winter_r</option>
			<option value="Accent_r">Accent_r</option>
			<option value="Dark2_r">Dark2_r</option>
			<option value="Paired_r">Paired_r</option>
			<option value="Pastel1_r">Pastel1_r</option>
			<option value="Pastel2_r">Pastel2_r</option>
			<option value="Set1_r">Set1_r</option>
			<option value="Set2_r">Set2_r</option>
			<option value="Set3_r">Set3_r</option>
			<option value="tab10_r">tab10_r</option>
			<option value="tab20_r">tab20_r</option>
			<option value="tab20b_r">tab20b_r</option>
			<option value="tab20c_r">tab20c_r</option>
		</select>
		<label for="cmaps-min1"><b>Min 1:</b> </label>
		<input id="cmaps-min1" type="number" value="10.0">
		<label for="cmaps-max1"><b>Max 1:</b> </label>
		<input id="cmaps-max1" type="number" value="66.66666666666667">
		<label for="cmaps-min1"><b>Scale 1:</b> </label>
		<select id="cmaps-scale1">
			<option value="linear" selected="selected">linear</option>
			<option value="log">log</option>
			<option value="sqrt">sqrt</option>
			<option value="power">power</option>
			<option value="asinh">asinh</option>
		</select>

		<br><br>
			&nbsp <label for="back-choice"><b>Background:</b> </label>
			<input oninput="change_background()" id="back-choice" type="color" value="#999999">
		&nbsp <label for="scalev"><b>Z scale:</b> </label>
		<input oninput="changescalev()" id="scalev" type="range" list="marker" min="0" max="5" step="0.001" value="1"/>
		<datalist id="marker">
			<option value="1"></option>
		</datalist>
	</div>
		<script>
		const inpscasv = document.querySelector('#scalev');
		function changescalev()
		 {
			const sca = inpscasv.value;
			document.getElementById('cube__0lt0_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__0lt1_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__0lt2_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__0lt3_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__1lt0_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__1lt1_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__1lt2_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__1lt3_sp0').setAttribute('scale', '1 1 '+sca);
			document.getElementById('cube__ot').setAttribute('scale', '1 1 '+sca);
			 document.getElementById('cube__tlt').setAttribute('scale', '1 1 '+sca);
	if (document.getElementById('new-sphere')[0].value != 'none') {
		for (s=0; s<document.getElementById('new-sphere').length; s++) {
			const sphInd = document.getElementById('new-sphere')[s].value.slice(3);
			document.getElementById('sphtra'+sphInd).setAttribute('translation', sph_coords[sphInd-1][0]+' '+sph_coords[sphInd-1][1]+' '+sca*sph_coords[sphInd-1][2]);
			document.getElementById('sphlabtra'+sphInd).setAttribute('translation', sph_coords[sphInd-1][0]+' '+sph_coords[sphInd-1][1]+' '+sca*sph_coords[sphInd-1][2]);
		}
	}
	if (document.getElementById('new-box')[0].value != 'none') {
		for (s=0; s<document.getElementById('new-box').length; s++) {
			const boxInd = document.getElementById('new-box')[s].value.slice(3);
			document.getElementById('boxtra'+boxInd).setAttribute('translation', box_coords[boxInd-1][0]+' '+box_coords[boxInd-1][1]+' '+sca*box_coords[boxInd-1][2]);
			document.getElementById('boxlabtra'+boxInd).setAttribute('translation', box_coords[boxInd-1][0]+' '+box_coords[boxInd-1][1]+' '+sca*box_coords[boxInd-1][2]);
		}
	}
	if (document.getElementById('new-con')[0].value != 'none') {
		for (s=0; s<document.getElementById('new-con').length; s++) {
			const conInd = document.getElementById('new-con')[s].value.slice(3);
			document.getElementById('contra'+conInd).setAttribute('translation', con_coords[conInd-1][0]+' '+con_coords[conInd-1][1]+' '+sca*con_coords[conInd-1][2]);
			document.getElementById('conlabtra'+conInd).setAttribute('translation', con_coords[conInd-1][0]+' '+con_coords[conInd-1][1]+' '+sca*con_coords[conInd-1][2]);
			// missing orientation change (don't implement?)
		}
	}
	if (document.getElementById('new-tub')[0].value != 'none') {
		for (s=0; s<document.getElementById('new-tub').length; s++) {
			const tubInd = document.getElementById('new-tub')[s].value.slice(3);
			for (i=1; i<tubelen[tubInd-1]; i++) {
				document.getElementById('tubtra'+tubInd+'_'+i).setAttribute('translation', tub_coords[tubInd-1][i-1][0][0]+' '+tub_coords[tubInd-1][i-1][0][1]+' '+sca*tub_coords[tubInd-1][i-1][0][2]);
				const norm = Math.sqrt(tub_coords[tubInd-1][i-1][1][0]**2+tub_coords[tubInd-1][i-1][1][1]**2+(tub_coords[tubInd-1][i-1][1][2]*sca)**2)*1.015;
				const angle = Math.acos(tub_coords[tubInd-1][i-1][1][1]/norm);
				document.getElementById('tubtra'+tubInd+'_'+i).setAttribute('rotation', tub_coords[tubInd-1][i-1][1][2]*sca+' 0 '+(-tub_coords[tubInd-1][i-1][1][0])+' '+angle);
				document.getElementById('tub'+tubInd+'_'+i).setAttribute('height', norm);
			}
			document.getElementById('tublabtra'+tubInd).setAttribute('translation', tub_coords[tubInd-1][0][0][0]+' '+tub_coords[tubInd-1][0][0][1]+' '+sca*tub_coords[tubInd-1][0][0][2]);
		}
	}
			document.getElementById('cube__alt_diff0').setAttribute('translation', '0.0 -1100.0 '+sca*-1000.0);
			document.getElementById('cube__att_diff0').setAttribute('translation', '1000.0 -1100.0 '+sca*-1000.0);
			document.getElementById('cube__alt_diff1').setAttribute('translation', '1100.0 0.0 '+sca*-1000.0);
			document.getElementById('cube__att_diff1').setAttribute('translation', '-1000.0 -1100.0 '+sca*-1000.0);
			document.getElementById('cube__alt_diff2').setAttribute('translation', '-1000.0 -1100.0 '+sca*0.0);
			document.getElementById('cube__att_diff2').setAttribute('translation', '1100.0 1000.0 '+sca*-1000.0);
			document.getElementById('cube__alt_diff3').setAttribute('translation', '-1000.0 0.0 '+sca*-1100.0);
			document.getElementById('cube__att_diff3').setAttribute('translation', '1100.0 -1000.0 '+sca*-1000.0);
			document.getElementById('cube__alt_diff4').setAttribute('translation', '-1100.0 1000.0 '+sca*0.0);
			document.getElementById('cube__att_diff4').setAttribute('translation', '-1000.0 -1100.0 '+sca*-1000.0);
			document.getElementById('cube__alt_diff5').setAttribute('translation', '0.0 1000.0 '+sca*-1100.0);
			document.getElementById('cube__att_diff5').setAttribute('translation', '-1000.0 -1100.0 '+sca*1000.0);
			document.getElementById('cube__att_diff6').setAttribute('translation', '-1000.0 1000.0 '+sca*-1100.0);
			document.getElementById('cube__att_diff7').setAttribute('translation', '-1000.0 -1000.0 '+sca*-1100.0);
			document.getElementById('cube__att_diff8').setAttribute('translation', '-1100.0 1000.0 '+sca*-1000.0);
			document.getElementById('cube__att_diff9').setAttribute('translation', '-1100.0 1000.0 '+sca*1000.0);
			document.getElementById('cube__att_diff10').setAttribute('translation', '1000.0 1000.0 '+sca*-1100.0);
			document.getElementById('cube__att_diff11').setAttribute('translation', '-1000.0 1000.0 '+sca*-1100.0);
		}
		</script>
		
		<div id="divmaster" style="margin-left: 2%">
			<br>
			<!-- BUTTON TO CHANGE LAYOUT -->
			<label for="markers-choice"><b>Markers:</b> </label>
			<select id="markers-choice">
				<option value="none">None</option>
				<option value="sphere">Sphere</option>
				<option value="box">Box</option>
				<option value="tub">Tube</option>
				<option value="con">Cone</option>
			</select>
			<input type="color" id="butcol" value="#ff0000">
			<button id="butnew" onclick="newmarker()">New</button>
			<button id="butcreate" onclick="createmarker()">Create</button>
			<button id="butremove" onclick="removemarker()">Remove</button>
			<button id="buthide" onclick="hidemarker()">Hide/Show</button> <br><br>
		</div>
		<!-- create various layouts for different objects -->
		<div id="spherediv" style="display:none ; margin-left: 2%">
			<select id="new-sphere">
				<option value="none">None</option>
			</select>
			<br>
		</div>
		<div id="boxdiv" style="display:none ; margin-left: 2%">
			<select id="new-box">
				<option value="none">None</option>
			</select>
			<br>
		</div>
		<div id="condiv" style="display:none ; margin-left: 2%">
			<select id="new-con">
				<option value="none">None</option>
			</select>
			<br>
		</div>
		<div id="tubdiv" style="display:none ; margin-left: 2%">
			<select id="new-tub">
				<option value="none">None</option>
			</select>
			<button id="addpoint" onclick="addpoint(seltub, tubelen)">Add point</button>
			<br>
		</div>
		<script type="text/javascript">
			// General parameters
			const marktype = document.querySelector('#markers-choice');
			marktype.addEventListener('change', newlayout);
			const sscasv = document.querySelector('#scalev');
			const col = document.querySelector('#butcol');

			// Spheres
			var nspheres = 0; //number of spheres
			var sph_coords = []; //coordinates of sphere

			const selsph = document.querySelector('#new-sphere');
			selsph.addEventListener('change', changeSphere);

			// Boxes
			var nboxes = 0; //number of boxes
			var box_coords = []; //coordinates of boxes

			const selbox = document.querySelector('#new-box');
			selbox.addEventListener('change', changeBox);

			// Cones
			var ncones = 0; //number of cones
			var con_coords = []; //coordinates of cones

			const selcon = document.querySelector('#new-con');
			selcon.addEventListener('change', changeCon);

			// Tubes
			var ntubes = 0; //number of tubes
			var tub_coords = []; //coordinates of tubes
			var tubelen = []; //lengths of tubes in number of cylinders

			const seltub = document.querySelector('#new-tub');
			seltub.addEventListener('change', changeTub);

			// General
			function newmarker() {
				if (marktype.value == 'sphere') {
					nspheres = nspheres += 1;
					nspheres = newSphere(nspheres, selsph);
				} else if (marktype.value == 'box') {
					nboxes = nboxes += 1;
					nboxes = newBox(nboxes, selbox);
				} else if (marktype.value == 'tub') {
					ntubes = ntubes += 1;
					ntubes, tubelen = newTub(ntubes, seltub, tubelen);
				} else if (marktype.value == 'con') {
					ncones = ncones += 1;
					ncones = newCon(ncones, selcon);
			}
		}

			function createmarker() {
				const sca = inpscasv.value;

				const means = [32.54458333333365, -10.27138888893355, 3851270.7779528205];
				const delt = [0.004375000000008751, 0.005185185185195568, 20369.030720803345];
				const trans = [16.666666666666668, 22.22222222222222, 55.55555555555556];
				if (marktype.value == 'sphere') {
					sph_coords = createSphere(sca, selsph, col, sph_coords, means, delt, trans);
				} else if (marktype.value == 'box') {
					box_coords = createBox(sca, selbox, col, box_coords, means, delt, trans);
				} else if (marktype.value == 'tub') {
					tub_coords = createTub(sca, seltub, col, tub_coords, tubelen, means, delt, trans);
				} else if (marktype.value == 'con') {
					con_coords = createCon(sca, selcon, col, con_coords, means, delt, trans);
			}
		}

			function removemarker() {
				if (marktype.value == 'sphere') {
					removeSphere(selsph);
				} else if (marktype.value == 'box') {
					removeBox(selbox);
				} else if (marktype.value == 'tub') {
					removeTub(seltub, tubelen);
				} else if (marktype.value == 'con') {
					removeCon(selcon);
			}
		}
			function hidemarker() {
				if (marktype.value == 'sphere') {
					hideSphere(selsph);
				} else if (marktype.value == 'box') {
					hideBox(selbox);
				} else if (marktype.value == 'tub') {
					hideTub(seltub, tubelen);
				} else if (marktype.value == 'con') {
					hideCon(selcon);
			}
		}
		</script>
			<script>
				function hex2Rgb(hex) {
					var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
					var r = parseInt(result[1], 16)/255.;
					var g = parseInt(result[2], 16)/255.;
					var b = parseInt(result[3], 16)/255.;
					return r.toString()+' '+g.toString()+' '+b.toString()
				}
				const background = document.querySelector('#back-choice');
				function change_background() {
					const backCol = background.value; 
					document.getElementById('cube__back').setAttribute('skyColor', hex2Rgb(backCol));
				}
			</script>
		 <!--MUST BE BELOW THE <select> ELEMENT-->
		<script>
			const cc0 = document.querySelector('#cmaps-choice0');
			cc0.addEventListener('change', change_colormap0);
			const cmapmin0 = document.querySelector('#cmaps-min0');
			cmapmin0.addEventListener('change', change_colormap0);
			const cmapmax0 = document.querySelector('#cmaps-max0');
			cmapmax0.addEventListener('change', change_colormap0);
			const cmapscale0 = document.querySelector('#cmaps-scale0');
			cmapscale0.addEventListener('change', change_colormap0);
			const isolevels0 = [10.        , 20.        , 33.33333333, 66.66666667];
			function change_colormap0() {
				var cmap0 = cc0.value;
				var min0 = cmapmin0.value;
				var max0 = cmapmax0.value;
				const scale0 = cmapscale0.value;
				var reverse0 = false;
				var collevs0 = [];
				if (scale0 === 'linear') {
					for (const level of isolevels0) {
						collevs0.push(level);
					}
				}
				else if (scale0 === 'log') {
					min0 = Math.log(min0);
					max0 = Math.log(max0);
					for (const level of isolevels0) {
						collevs0.push(Math.log(level));
					}
				}
				else if (scale0 === 'sqrt') {
					min0 = Math.sqrt(min0);
					max0 = Math.sqrt(max0);
					for (const level of isolevels0) {
						collevs0.push(Math.sqrt(level));
					}
				}
				else if (scale0 === 'power') {
					min0 = Math.pow(min0, 2);
					max0 = Math.pow(max0, 2);
					for (const level of isolevels0) {
						collevs0.push(Math.pow(level, 2));
					}
				}
				else if (scale0 === 'asinh') {
					min0 = Math.asinh(min0);
					max0 = Math.asinh(max0);
					for (const level of isolevels0) {
						collevs0.push(Math.asinh(level));
					}
				}
				for (let lev = 0; lev < isolevels0.length; lev++) {
					if (min0 >= collevs0[lev]) {
						collevs0[lev] = 0;
					} else if (max0 <= collevs0[lev]) {
						collevs0[lev] = 1;
					} else {
						collevs0[lev] = (collevs0[lev] - min0) / (max0 - min0);
					}
					if (cmap0.endsWith('_r')) {
						reverse0 = true
					}
					if (cmap0.includes('gist_rainbow')) {
						var color0 = evaluate_cmap(collevs0[lev], 'gist_rainbow', reverse0);
					} else {
						var color0 = evaluate_cmap(collevs0[lev], cmap0.replace('_r', ''), reverse0);
					}
					var split0 = [1, 1, 1, 1];
					for (let sp = 0; sp < split0[lev]; sp++) {
						document.getElementById('cube__0layer'+lev+'_sp'+sp).setAttribute('diffuseColor', color0[0]/255+' '+color0[1]/255+' '+color0[2]/255);
					}
					document.getElementById('0but'+lev).style.background = 'rgb('+color0[0]+' '+color0[1]+' '+color0[2]+')';
					if ((color0[0]*0.299 + color0[1]*0.587 + color0[2]*0.114) > 130) {
						document.getElementById('0but'+lev).style.color = 'black';
					} else {
						document.getElementById('0but'+lev).style.color = 'white';
					}
				}
			}
		</script>
		<script>
			const cc1 = document.querySelector('#cmaps-choice1');
			cc1.addEventListener('change', change_colormap1);
			const cmapmin1 = document.querySelector('#cmaps-min1');
			cmapmin1.addEventListener('change', change_colormap1);
			const cmapmax1 = document.querySelector('#cmaps-max1');
			cmapmax1.addEventListener('change', change_colormap1);
			const cmapscale1 = document.querySelector('#cmaps-scale1');
			cmapscale1.addEventListener('change', change_colormap1);
			const isolevels1 = [10.        , 20.        , 33.33333333, 66.66666667];
			function change_colormap1() {
				var cmap1 = cc1.value;
				var min1 = cmapmin1.value;
				var max1 = cmapmax1.value;
				const scale1 = cmapscale1.value;
				var reverse1 = false;
				var collevs1 = [];
				if (scale1 === 'linear') {
					for (const level of isolevels1) {
						collevs1.push(level);
					}
				}
				else if (scale1 === 'log') {
					min1 = Math.log(min1);
					max1 = Math.log(max1);
					for (const level of isolevels1) {
						collevs1.push(Math.log(level));
					}
				}
				else if (scale1 === 'sqrt') {
					min1 = Math.sqrt(min1);
					max1 = Math.sqrt(max1);
					for (const level of isolevels1) {
						collevs1.push(Math.sqrt(level));
					}
				}
				else if (scale1 === 'power') {
					min1 = Math.pow(min1, 2);
					max1 = Math.pow(max1, 2);
					for (const level of isolevels1) {
						collevs1.push(Math.pow(level, 2));
					}
				}
				else if (scale1 === 'asinh') {
					min1 = Math.asinh(min1);
					max1 = Math.asinh(max1);
					for (const level of isolevels1) {
						collevs1.push(Math.asinh(level));
					}
				}
				for (let lev = 0; lev < isolevels1.length; lev++) {
					if (min1 >= collevs1[lev]) {
						collevs1[lev] = 0;
					} else if (max1 <= collevs1[lev]) {
						collevs1[lev] = 1;
					} else {
						collevs1[lev] = (collevs1[lev] - min1) / (max1 - min1);
					}
					if (cmap1.endsWith('_r')) {
						reverse1 = true
					}
					if (cmap1.includes('gist_rainbow')) {
						var color1 = evaluate_cmap(collevs1[lev], 'gist_rainbow', reverse1);
					} else {
						var color1 = evaluate_cmap(collevs1[lev], cmap1.replace('_r', ''), reverse1);
					}
					var split1 = [1, 1, 1, 1];
					for (let sp = 0; sp < split1[lev]; sp++) {
						document.getElementById('cube__1layer'+lev+'_sp'+sp).setAttribute('diffuseColor', color1[0]/255+' '+color1[1]/255+' '+color1[2]/255);
					}
					document.getElementById('1but'+lev).style.background = 'rgb('+color1[0]+' '+color1[1]+' '+color1[2]+')';
					if ((color1[0]*0.299 + color1[1]*0.587 + color1[2]*0.114) > 130) {
						document.getElementById('1but'+lev).style.color = 'black';
					} else {
						document.getElementById('1but'+lev).style.color = 'white';
					}
				}
			}
		</script>

<!--A table with navigation info for X3DOM-->
<br/>
<hr>
<h3><b>Navigation:</b></h3>
<table style="border-collapse: collapse; border: 2px solid rgb(0,0,0);">
<tbody><tr style="background-color: rgb(220,220,220); border: 1px solid rgb(0,0,0);">
<th width="250px">Function</th>
<th>Mouse Button</th>
</tr>
</tbody><tbody>
<tr style="background-color: rgb(240,240,240);"><td>Rotate</td>
<td>Left / Left + Shift</td>
</tr>
<tr><td>Pan</td>
<td>Mid / Left + Ctrl</td>
</tr>
<tr style="background-color: rgb(240,240,240);"><td>Zoom</td>
<td>Right / Wheel / Left + Alt</td>
</tr>
<tr><td>Set center of rotation</td>
<td>Double-click left</td>
</tr>
</tbody>
</table>
<p>Zooming with the mouse wheel is not as smooth as with the right mouse button or with Alt + Left.<p>
	</body>
</html>